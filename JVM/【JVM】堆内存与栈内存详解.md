###**堆和栈的定义**

java把内存分成栈内存和堆内存。

（1）栈内存

* 在函数中定义的一些基本类型的变量和对象的引用变量都是在函数的栈内存中分配。

* 当在一段代码块中定义一个变量时，java就在栈中为这个变量分配内存空间，当超过变量的作用域后，java会自动释放掉为该变量分配的内存空间，该内存空间可以立刻被另作他用。


（2）堆内存

* 堆内存用于存放由new创建的对象和数组。在堆中分配的内存，由java虚拟机自动垃圾回收器来管理。

* 在堆中产生了一个数组或者对象后，还可以在栈中定义一个特殊的变量，这个变量的取值等于数组或者对象在堆内存中的首地址，在栈中的这个特殊的变量就变成了数组或者对象的引用变量，以后就可以在程序中使用栈内存中的引用变量来访问堆中的数组或者对象，引用变量相当于为数组或者对象起的一个别名，或者代号。

（3）注意

* 引用变量是普通变量，定义时在栈中分配内存，引用变量在程序运行到作用域外释放。而数组＆对象本身在堆中分配，即使程序运行到使用new产生数组和对象的语句所在地代码块之外，

* 数组和对象本身占用的堆内存也不会被释放，数组和对象在没有引用变量指向它的时候，才变成垃圾，不能再被使用，但是仍然占着内存，在随后的一个不确定的时间被垃圾回收器释放掉。这个也是java比较占内存的主要原因，

* 实际上，栈中的变量指向堆内存中的变量，这就是 Java 中的指针!

###**堆和栈的异同**

####**1.堆和栈的区别**

* 堆
 * 堆是一个运行时数据区,类的(对象从中分配空间。这些对象通过new、newarray、 anewarray和multianewarray等指令建立，它们不需要程序代码来显式的释放。堆是由垃圾回收来负责的，
 * 程序开始运行时，JVM从OS获取一些内存，部分是堆内存。堆内存通常在存储地址的底层，向上排列。              
 * 堆是一个"运行时"数据区，类实例化的对象就是从堆上去分配空间的；       
 * 在堆上分配空间是通过"new"等指令建立的，堆是动态分配的内存大小，生存期也不必事先告诉编译器；
 * 与C++不同的是，Java自动管理堆和栈，垃圾回收器可以自动回收不再使用的堆内存；    


   

* 栈
 * 栈中主要存放一些基本类型的变量(,int, short, long, byte, float, double, boolean, char)和引用类型。 
 * 先进后出的数据结构,通常用于保存方法中的参数,局部变量；
 * 在java中,所有基本类型（short,int, long, byte, float, double,boolean, char）和引用类型的变量都在栈中存储；
 * 栈中数据的生存空间一般在当前scopes内(由{...}括起来的区域；

####**2.堆和栈的优缺点**

* 堆的优缺点
 * 堆的优点：可以动态地分配内存大小，生存期也不必事先告诉编译器，因为它是在运行时动态分配内存的，Java的垃圾收集器会自动收走这些不再使用的数据。
 * 堆的缺点：由于要在运行时动态分配内存，存取速度较慢。 

* 栈的优缺点
 * 栈的优点：存取速度比堆要快，仅次于寄存器，栈数据可以共享，多个引用可以指向同一个地址。
 * 栈的缺点：存在栈中的数据大小与生存期必须是确定的，缺乏灵活性。



####**3.堆和栈的联系**

* 在堆中产生了一个数组或对象后，还可以在栈中定义一个特殊的变量，让栈中这个变量的取值等于数组或对象在堆内存中的首地址，栈中的这个变量就成了数组或对象的引用变量。 


<br>
<br>
本人才疏学浅，若有错，请指出
谢谢！ 　